@using System.Reactive.Concurrency
@using Occurify.Reactive.Extensions
@using Occurify.TimeZones

<div class="clock-container @(Centered ? "center" : "top")">
    <h1><button @onclick="OnClick" class="unstyled-button"><b>@_currentTime.ToString("HH:mm")</b></button></h1>
</div>

@code {
    [Parameter] public bool Centered { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }

    private DateTime _currentTime = DateTime.Now;

    protected override void OnInitialized()
    {
        var scheduler = new SynchronizationContextScheduler(SynchronizationContext.Current!);
        TimeZoneInstants.EveryMinute().Subscribe(t =>
        {
            _currentTime = t;
            StateHasChanged();
        }, scheduler);
    }
}

<style>
    .clock-container {
        pointer-events: none;
        position: fixed;
        width: 100%;
        transition: all 0.5s ease;
        text-align: center;
    }

        .clock-container button {
            pointer-events: auto;
        }

        .clock-container.center {
            top: 50%;
            transform: translateY(-50%);
        }

        .clock-container.top {
            top: 20px;
            transform: translateY(0);
        }

        .clock-container h1 {
            margin: 0;
            transition: font-size 1s ease;
            font-size: 30vw;
        }

        .clock-container.top h1 {
            font-size: 15vw;
        }
</style>